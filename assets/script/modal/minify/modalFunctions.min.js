let modal=null
export const openModal=function(event){event.preventDefault()
const link=event.target.closest('a')
modal=document.querySelector(link.getAttribute('href'))
modal.style.display=null
modal.removeAttribute('aria-hidden')
modal.setAttribute('aria-modal','true')
document.body.classList.add('no-scroll');modal.addEventListener('click',closeModal)
modal.querySelectorAll('.js-modal-stop').forEach(content=>content.addEventListener('click',stopPropagation))
showImage(event)
modal.querySelector('.prev-image').addEventListener('click',prevImage)
modal.querySelector('.next-image').addEventListener('click',nextImage)}
const nextImage=function(event){event.preventDefault()
let index=findIndex()
const imageCollection=Array.from(document.querySelectorAll(".gallery-grid img[aria-hidden='false']"))
const nextIndex=(index+1+imageCollection.length)%imageCollection.length;const nextImage=imageCollection[nextIndex];modal.querySelector('.js-image img').src=nextImage.src}
const prevImage=function(event){event.preventDefault()
let index=findIndex()
const imageCollection=Array.from(document.querySelectorAll(".gallery-grid img[aria-hidden='false']"))
const prevIndex=(index-1+imageCollection.length)%imageCollection.length;const prevImage=imageCollection[prevIndex];modal.querySelector('.js-image img').src=prevImage.src}
const findIndex=function(){const imageCollection=Array.from(document.querySelectorAll(".gallery-grid img[aria-hidden='false']"))
let index=0
for(let i=0;i<imageCollection.length;i++){if(imageCollection[i].src===modal.querySelector('.js-image img').src){index=i}}
return index}
const showImage=function(event){const targetImage=event.target
const imageContainer=modal.querySelector('.js-image')
if(imageContainer.querySelector('img')){imageContainer.querySelector('img').remove()}
const imageModal=document.createElement('img')
imageModal.src=targetImage.src
imageContainer.appendChild(imageModal)}
const closeModal=function(event){if(modal===null)return
event.preventDefault()
window.setTimeout(function(){modal.style.display="none"
modal=null},500)
modal.setAttribute('aria-hidden','true')
modal.removeAttribute('aria-modal')
document.body.classList.remove('no-scroll');modal.removeEventListener('click',closeModal)
modal.querySelectorAll('.js-modal-stop').forEach(content=>content.removeEventListener('click',stopPropagation))
modal.querySelector('.prev-image').removeEventListener('click',prevImage)
modal.querySelector('.prev-image').removeEventListener('click',nextImage)}
const stopPropagation=function(event){event.stopPropagation()}